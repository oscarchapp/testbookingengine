{% extends "main.html" %}
{% block content %}
<div class="container py-5">
  <div class="card shadow-lg mx-auto" style="max-width: 600px;">
    <div class="card-header bg-primary text-white text-center">
      <h4 class="mb-0">Nueva Reserva</h4>
    </div>
    <div class="card-body">
      <form action="{% url 'search' %}" method="POST" novalidate>
        {% csrf_token %}
        {% for field in form %}
          <div class="mb-4">
            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{ field.label }}</label>
            {{ field }}
            {% if field.errors %}
              <div class="text-danger small mt-1">{{ field.errors|striptags }}</div>
            {% endif %}
          </div>
        {% endfor %}
        <div class="mb-4">
          <label class="form-label fw-semibold">Días de estadía:</label>
          <span id="total-days" class="fs-5 fw-bold">0</span>
        </div>
        <div class="d-flex justify-content-between">
          <button type="reset" class="btn btn-outline-secondary">Limpiar</button>
          <button type="submit" class="btn btn-success">Buscar Disponibilidad</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% load static %}
<script src="{% static 'js/search_room.js' %}"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('form input, form select').forEach(el => {
      el.classList.add('form-control', 'form-control-lg');
    });

    // Calcular días entre fechas
    const dateInputs = ['{{ form.prefix }}-checkin', '{{ form.prefix }}-checkout'];
    dateInputs.forEach(id => {
      const input = document.getElementById(id);
      if (input) input.addEventListener('change', updateDays);
    });

    function updateDays() {
      const inDate = new Date(document.getElementById(dateInputs[0]).value);
      const outDate = new Date(document.getElementById(dateInputs[1]).value);
      const diff = (outDate - inDate) / (1000 * 60 * 60 * 24);
      document.getElementById('total-days').textContent = diff > 0 ? diff : 0;
    }
  });
</script>

<style>
  .form-label { font-size: 1rem; }
  .btn-outline-secondary:hover {
    background-color: #6c757d;
    color: #fff;
  }
  .card {
    border-radius: 0.5rem;
  }
  .btn-success {
    border-radius: 0.5rem;
  }
</style>
{% endblock content %}
